{"ast":null,"code":"import _objectSpread from \"D:\\\\Github\\\\Diplomarbeit\\\\errorkb-frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"D:\\\\Github\\\\Diplomarbeit\\\\errorkb-frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"D:\\\\Github\\\\Diplomarbeit\\\\errorkb-frontend\\\\src\\\\components\\\\Dashboard.jsx\";\nimport React, { Component, useEffect } from 'react';\nimport '../App.css';\nimport { useCookies } from \"react-cookie\";\nimport { forwardRef } from 'react';\nimport MaterialTable from 'material-table';\nimport AddBox from '@material-ui/icons/AddBox';\nimport ArrowDownward from '@material-ui/icons/ArrowDownward';\nimport Check from '@material-ui/icons/Check';\nimport ChevronLeft from '@material-ui/icons/ChevronLeft';\nimport ChevronRight from '@material-ui/icons/ChevronRight';\nimport Clear from '@material-ui/icons/Clear';\nimport DeleteOutline from '@material-ui/icons/DeleteOutline';\nimport Edit from '@material-ui/icons/Edit';\nimport FilterList from '@material-ui/icons/FilterList';\nimport FirstPage from '@material-ui/icons/FirstPage';\nimport LastPage from '@material-ui/icons/LastPage';\nimport Remove from '@material-ui/icons/Remove';\nimport SaveAlt from '@material-ui/icons/SaveAlt';\nimport Search from '@material-ui/icons/Search';\nimport ViewColumn from '@material-ui/icons/ViewColumn';\nimport { makeStyles } from \"@material-ui/core/styles\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    '& .MuiTextField-root': {\n      margin: theme.spacing(1),\n      width: 250\n    }\n  }\n}));\nconst tableIcons = {\n  Add: forwardRef((props, ref) => React.createElement(AddBox, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33\n    },\n    __self: this\n  }))),\n  Check: forwardRef((props, ref) => React.createElement(Check, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34\n    },\n    __self: this\n  }))),\n  Clear: forwardRef((props, ref) => React.createElement(Clear, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35\n    },\n    __self: this\n  }))),\n  Delete: forwardRef((props, ref) => React.createElement(DeleteOutline, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36\n    },\n    __self: this\n  }))),\n  DetailPanel: forwardRef((props, ref) => React.createElement(ChevronRight, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37\n    },\n    __self: this\n  }))),\n  Edit: forwardRef((props, ref) => React.createElement(Edit, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38\n    },\n    __self: this\n  }))),\n  Export: forwardRef((props, ref) => React.createElement(SaveAlt, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39\n    },\n    __self: this\n  }))),\n  Filter: forwardRef((props, ref) => React.createElement(FilterList, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40\n    },\n    __self: this\n  }))),\n  FirstPage: forwardRef((props, ref) => React.createElement(FirstPage, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41\n    },\n    __self: this\n  }))),\n  LastPage: forwardRef((props, ref) => React.createElement(LastPage, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42\n    },\n    __self: this\n  }))),\n  NextPage: forwardRef((props, ref) => React.createElement(ChevronRight, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43\n    },\n    __self: this\n  }))),\n  PreviousPage: forwardRef((props, ref) => React.createElement(ChevronLeft, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44\n    },\n    __self: this\n  }))),\n  ResetSearch: forwardRef((props, ref) => React.createElement(Clear, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45\n    },\n    __self: this\n  }))),\n  Search: forwardRef((props, ref) => React.createElement(Search, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46\n    },\n    __self: this\n  }))),\n  SortArrow: forwardRef((props, ref) => React.createElement(ArrowDownward, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47\n    },\n    __self: this\n  }))),\n  ThirdStateCheck: forwardRef((props, ref) => React.createElement(Remove, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48\n    },\n    __self: this\n  }))),\n  ViewColumn: forwardRef((props, ref) => React.createElement(ViewColumn, Object.assign({}, props, {\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  })))\n};\n\nvar request = require('superagent');\n\nexport default function Dashboard() {\n  const _React$useState = React.useState({\n    columns: [{\n      title: 'ID',\n      field: 'id'\n    }, {\n      title: 'Status',\n      field: 'status'\n    }, {\n      title: 'Title',\n      field: 'title'\n    }, {\n      title: 'Description',\n      field: 'desc'\n    }, {\n      title: 'Assigned user',\n      field: 'user'\n    }, {\n      title: 'Creation date',\n      field: 'date'\n    }, {\n      title: 'Solution',\n      field: 'solution'\n    }],\n    data: []\n  }),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        state = _React$useState2[0],\n        setState = _React$useState2[1];\n\n  const getEntries = async () => {\n    const url = \"http://localhost/errorkb/api/GetAllEntries\";\n    const response = await fetch(url);\n    const entrydata = await response.json();\n\n    for (let i = 0; i < entrydata.length; i++) {\n      new Promise(resolve => {\n        {\n          resolve();\n          setState(prevState => {\n            const data = [...prevState.data];\n            data.push({\n              id: entrydata[i].id,\n              status: entrydata[i].status,\n              title: entrydata[i].title,\n              desc: entrydata[i].description.slice(0, 50),\n              user: entrydata[i].user,\n              date: entrydata[i].timestamp,\n              solution: entrydata[i].solution\n            });\n            return _objectSpread({}, prevState, {\n              data\n            });\n          });\n        }\n      });\n    }\n\n    console.log(entrydata);\n  };\n\n  useEffect(() => {\n    getEntries();\n  }, []);\n  return React.createElement(MaterialTable, {\n    title: \"Entries\",\n    columns: state.columns,\n    data: state.data,\n    icons: tableIcons,\n    editable: {\n      onRowAdd: newData => new Promise(resolve => {\n        setTimeout(() => {\n          resolve();\n          setState(async prevState => {\n            const data = [...prevState.data];\n\n            if (newData.status == \"\") {\n              newData.status = \"open\";\n            }\n\n            if (newData.timestamp != null) {\n              alert(\"Timestamp not valid\");\n              return _objectSpread({}, prevState, {\n                data\n              });\n            }\n\n            if (newData.user == \"\") {\n              alert(\"Assign this entry to an user!\");\n              return _objectSpread({}, prevState, {\n                data\n              });\n            }\n\n            if (newData.status == \"closed\" && newData.solution == \"\") {\n              alert(\"Error: You wanted to close this entry but did not provide any solution\");\n              return _objectSpread({}, prevState, {\n                data\n              });\n            }\n\n            if (newData.title == \"\" || newData.desc == \"\") {\n              alert(\"Please give this entry a title and a description\");\n              return _objectSpread({}, prevState, {\n                data\n              });\n            }\n\n            if (newData.id != \"\") {\n              alert(\"Error: Invalid ID\");\n              return _objectSpread({}, prevState, {\n                data\n              });\n            }\n\n            const url = \"http://localhost/errorkb/api/PostNewEntry/?tit=\" + newData.title + \"&desc=\" + newData.desc + \"&stat=\" + newData.status + \"&username=\" + newData.user;\n\n            try {\n              const response = await request('POST', url);\n\n              if (response.statusCode == 200) {\n                data.push(newData);\n                return _objectSpread({}, prevState, {\n                  data\n                });\n              }\n            } catch (error) {\n              alert(error.message);\n              return _objectSpread({}, prevState, {\n                data\n              });\n            } finally {\n              window.location.reload();\n            }\n          });\n        }, 600);\n      }),\n      onRowUpdate: (newData, oldData) => new Promise(resolve => {\n        setTimeout(() => {\n          resolve();\n\n          if (oldData) {\n            console.log(oldData.username);\n            console.log(newData);\n            setState(async prevState => {\n              const data = [...prevState.data];\n              const url = \"http://localhost/errorkb/api/PutNewUser/?oldUsername=\" + oldData.username + \"&oldPassword=\" + oldData.password + \"&newUsername=\" + newData.username + \"&newPassword=\" + newData.password + \"&newPriv=\" + newData.priv;\n\n              try {\n                const response = await request('PUT', url);\n\n                if (response.statusCode == 200) {\n                  data[data.indexOf(oldData)] = newData;\n                  return _objectSpread({}, prevState, {\n                    data\n                  });\n                }\n              } catch (error) {\n                alert(error.message);\n                return _objectSpread({}, prevState, {\n                  data\n                });\n              } finally {\n                window.location.reload();\n              }\n            });\n          }\n        }, 600);\n      }),\n      onRowDelete: oldData => new Promise(resolve => {\n        setTimeout(() => {\n          resolve();\n          setState(async prevState => {\n            const data = [...prevState.data];\n            const url = \"http://localhost/errorkb/Api/DeleteUser?username=\" + oldData.username;\n\n            try {\n              const response = await request('DELETE', url);\n\n              if (response.statusCode == 200) {\n                data.splice(data.indexOf(oldData), 1);\n                return _objectSpread({}, prevState, {\n                  data\n                });\n              }\n            } catch (error) {\n              alert(error.message);\n              return _objectSpread({}, prevState, {\n                data\n              });\n            } finally {\n              window.location.reload();\n            }\n          });\n        }, 600);\n      })\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  });\n}\nconst style = {\n  margin: 15\n};","map":{"version":3,"sources":["D:/Github/Diplomarbeit/errorkb-frontend/src/components/Dashboard.jsx"],"names":["React","Component","useEffect","useCookies","forwardRef","MaterialTable","AddBox","ArrowDownward","Check","ChevronLeft","ChevronRight","Clear","DeleteOutline","Edit","FilterList","FirstPage","LastPage","Remove","SaveAlt","Search","ViewColumn","makeStyles","useStyles","theme","root","margin","spacing","width","tableIcons","Add","props","ref","Delete","DetailPanel","Export","Filter","NextPage","PreviousPage","ResetSearch","SortArrow","ThirdStateCheck","request","require","Dashboard","useState","columns","title","field","data","state","setState","getEntries","url","response","fetch","entrydata","json","i","length","Promise","resolve","prevState","push","id","status","desc","description","slice","user","date","timestamp","solution","console","log","onRowAdd","newData","setTimeout","alert","statusCode","error","message","window","location","reload","onRowUpdate","oldData","username","password","priv","indexOf","onRowDelete","splice","style"],"mappings":"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","sourcesContent":["import React, {Component, useEffect} from 'react';\r\nimport '../App.css';\r\nimport {useCookies} from \"react-cookie\";\r\nimport { forwardRef } from 'react';\r\nimport MaterialTable from 'material-table';\r\nimport AddBox from '@material-ui/icons/AddBox';\r\nimport ArrowDownward from '@material-ui/icons/ArrowDownward';\r\nimport Check from '@material-ui/icons/Check';\r\nimport ChevronLeft from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRight from '@material-ui/icons/ChevronRight';\r\nimport Clear from '@material-ui/icons/Clear';\r\nimport DeleteOutline from '@material-ui/icons/DeleteOutline';\r\nimport Edit from '@material-ui/icons/Edit';\r\nimport FilterList from '@material-ui/icons/FilterList';\r\nimport FirstPage from '@material-ui/icons/FirstPage';\r\nimport LastPage from '@material-ui/icons/LastPage';\r\nimport Remove from '@material-ui/icons/Remove';\r\nimport SaveAlt from '@material-ui/icons/SaveAlt';\r\nimport Search from '@material-ui/icons/Search';\r\nimport ViewColumn from '@material-ui/icons/ViewColumn';\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        '& .MuiTextField-root': {\r\n            margin: theme.spacing(1),\r\n            width: 250,\r\n        },\r\n    },\r\n}));\r\n\r\nconst tableIcons = {\r\n    Add: forwardRef((props, ref) => <AddBox {...props} ref={ref} />),\r\n    Check: forwardRef((props, ref) => <Check {...props} ref={ref} />),\r\n    Clear: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\r\n    Delete: forwardRef((props, ref) => <DeleteOutline {...props} ref={ref} />),\r\n    DetailPanel: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\r\n    Edit: forwardRef((props, ref) => <Edit {...props} ref={ref} />),\r\n    Export: forwardRef((props, ref) => <SaveAlt {...props} ref={ref} />),\r\n    Filter: forwardRef((props, ref) => <FilterList {...props} ref={ref} />),\r\n    FirstPage: forwardRef((props, ref) => <FirstPage {...props} ref={ref} />),\r\n    LastPage: forwardRef((props, ref) => <LastPage {...props} ref={ref} />),\r\n    NextPage: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\r\n    PreviousPage: forwardRef((props, ref) => <ChevronLeft {...props} ref={ref} />),\r\n    ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\r\n    Search: forwardRef((props, ref) => <Search {...props} ref={ref} />),\r\n    SortArrow: forwardRef((props, ref) => <ArrowDownward {...props} ref={ref} />),\r\n    ThirdStateCheck: forwardRef((props, ref) => <Remove {...props} ref={ref} />),\r\n    ViewColumn: forwardRef((props, ref) => <ViewColumn {...props} ref={ref} />)\r\n};\r\n\r\nvar request = require('superagent');\r\n\r\n\r\n\r\nexport default function Dashboard() {\r\n\r\n    const [state, setState] = React.useState({\r\n        columns: [\r\n            { title: 'ID', field: 'id' },\r\n            { title: 'Status', field: 'status' },\r\n            { title: 'Title', field: 'title' },\r\n            { title: 'Description', field: 'desc' },\r\n            { title: 'Assigned user', field: 'user' },\r\n            { title: 'Creation date', field: 'date' },\r\n            { title: 'Solution', field: 'solution' },\r\n        ],\r\n        data: [\r\n\r\n        ],\r\n    });\r\n\r\n    const getEntries = async() => {\r\n\r\n        const url = \"http://localhost/errorkb/api/GetAllEntries\";\r\n        const response = await fetch(url);\r\n        const entrydata = await response.json();\r\n        for(let i = 0 ; i < entrydata.length; i++){\r\n            new Promise(resolve => {\r\n                {resolve();\r\n                    setState(prevState => {\r\n                        const data = [...prevState.data];\r\n                        data.push({id:entrydata[i].id,status:entrydata[i].status,title:entrydata[i].title,desc:entrydata[i].description.slice(0,50),user:entrydata[i].user,date:entrydata[i].timestamp,solution:entrydata[i].solution});\r\n                        return { ...prevState, data };\r\n                    });\r\n                }\r\n            })\r\n        }\r\n        console.log(entrydata)\r\n    }\r\n    useEffect(()=>{\r\n        getEntries();\r\n    },[]);\r\n\r\n        return(\r\n            <MaterialTable\r\n                title=\"Entries\"\r\n                columns={state.columns}\r\n                data={state.data}\r\n                icons={tableIcons}\r\n                editable={{\r\n                    onRowAdd: newData =>\r\n                        new Promise(resolve => {\r\n                            setTimeout(() => {\r\n                                resolve();\r\n                                setState(async prevState => {\r\n                                    const data = [...prevState.data];\r\n                                    if(newData.status == \"\"){\r\n                                        newData.status = \"open\"\r\n                                    }\r\n                                    if(newData.timestamp != null){\r\n                                        alert(\"Timestamp not valid\");\r\n                                        return { ...prevState, data };\r\n                                    }\r\n                                    if(newData.user == \"\"){\r\n                                        alert(\"Assign this entry to an user!\");\r\n                                        return { ...prevState, data };\r\n                                    }\r\n                                    if(newData.status == \"closed\" && newData.solution == \"\"){\r\n                                        alert(\"Error: You wanted to close this entry but did not provide any solution\");\r\n                                        return { ...prevState, data };\r\n                                    }\r\n                                    if(newData.title == \"\" || newData.desc == \"\"){\r\n                                        alert(\"Please give this entry a title and a description\");\r\n                                        return { ...prevState, data };\r\n                                    }\r\n                                    if(newData.id != \"\"){\r\n                                        alert(\"Error: Invalid ID\");\r\n                                        return { ...prevState, data };\r\n                                    }\r\n                                    const url = \"http://localhost/errorkb/api/PostNewEntry/?tit=\"+newData.title+\"&desc=\"+newData.desc+\"&stat=\"+newData.status+\"&username=\"+newData.user;\r\n                                    try{\r\n                                        const response = await request('POST',url);\r\n                                        if(response.statusCode==200){\r\n                                            data.push(newData);\r\n                                            return { ...prevState, data };\r\n                                        }\r\n                                    }\r\n                                    catch(error){\r\n                                        alert(error.message)\r\n                                        return { ...prevState, data };\r\n                                    }\r\n                                    finally{\r\n                                        window.location.reload();\r\n                                    }\r\n                                })\r\n                            }, 600);\r\n                        }),\r\n                    onRowUpdate:\r\n                        (newData, oldData) =>\r\n                            new Promise(resolve => {\r\n                                setTimeout(() => {\r\n                                    resolve();\r\n                                    if (oldData) {\r\n                                        console.log(oldData.username);\r\n                                        console.log(newData);\r\n                                        setState(async prevState => {\r\n                                            const data = [...prevState.data];\r\n                                            const url = \"http://localhost/errorkb/api/PutNewUser/?oldUsername=\"+ oldData.username+\"&oldPassword=\"+oldData.password+\"&newUsername=\"+newData.username+\"&newPassword=\"+newData.password+\"&newPriv=\"+newData.priv;\r\n                                            try{\r\n                                                const response = await request('PUT',url);\r\n                                                if(response.statusCode==200){\r\n                                                    data[data.indexOf(oldData)] = newData;\r\n                                                    return { ...prevState, data };\r\n                                                }\r\n                                            }\r\n                                            catch(error){\r\n                                                alert(error.message)\r\n                                                return { ...prevState, data };\r\n                                            }\r\n                                            finally{\r\n                                                window.location.reload();\r\n                                            }\r\n                                        })\r\n                                    }\r\n                                }, 600);\r\n                            }),\r\n                    onRowDelete: oldData =>\r\n                        new Promise(resolve => {\r\n                            setTimeout(() => {\r\n                                resolve();\r\n                                setState(async prevState => {\r\n                                    const data = [...prevState.data];\r\n                                    const url = \"http://localhost/errorkb/Api/DeleteUser?username=\"+oldData.username;\r\n                                    try{\r\n                                        const response = await request('DELETE',url);\r\n                                        if(response.statusCode==200){\r\n                                            data.splice(data.indexOf(oldData), 1);\r\n                                            return { ...prevState, data };\r\n                                        }\r\n                                    }\r\n                                    catch(error){\r\n                                        alert(error.message)\r\n                                        return { ...prevState, data };\r\n                                    }\r\n                                    finally{\r\n                                        window.location.reload();\r\n                                    }\r\n                                });\r\n                            }, 600);\r\n                        }),\r\n                }}\r\n            />\r\n\r\n\r\n\r\n        );\r\n\r\n}\r\n\r\n\r\nconst style = {\r\n    margin: 15,\r\n};\r\n"]},"metadata":{},"sourceType":"module"}